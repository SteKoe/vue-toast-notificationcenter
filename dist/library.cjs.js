"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var o=require("vue");function u(t){var e;typeof t.remove!="undefined"?t.remove():(e=t.parentNode)==null||e.removeChild(t)}function y(t,e,s={}){let i=document.querySelector(".v-toast-container");i||(i=document.createElement("div"),i.classList.add("v-toast-container"),document.body.appendChild(i));const n=o.h(t,e,s),r=document.createElement("div");return r.classList.add("v-toast--pending"),i.appendChild(r),o.render(n,r),n.component}class C{constructor(e,s){this.timer=-1,this.startedAt=Date.now(),this.callback=e,this.delay=s,this.start()}start(){this.timer=setTimeout(this.callback,this.delay)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}function _(t){return{all:t=t||new Map,on:function(e,s){var i=t.get(e);i?i.push(s):t.set(e,[s])},off:function(e,s){var i=t.get(e);i&&(s?i.splice(i.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var i=t.get(e);i&&i.slice().map(function(n){n(s)}),(i=t.get("*"))&&i.slice().map(function(n){n(e,s)})}}}const l=_();var T=(t,e)=>{const s=t.__vccOpts||t;for(const[i,n]of e)s[i]=n;return s};const b=o.defineComponent({props:{title:{type:String,required:!1},message:{type:String,required:!0},type:{type:String,default:"success"},context:{type:String,default:"default"},labelCloseAll:{type:String,default:"Close All"},duration:{type:Number,default:3e3},onDismiss:{type:Function,default:()=>()=>{}},onClick:{type:Function,default:()=>{}},pauseOnHover:{type:Boolean,default:!0}},setup(t){const e=d(),s=e.state(),i=o.ref(0);o.watchEffect(()=>{i.value=s.value.filter(g=>g.context===t.context).length});const n=o.ref(null),r=o.ref(!1),a=o.ref(!1),h=o.ref(null),v=o.ref(null);return{notificationStore:e,counter:i,root:n,isActive:r,isManualDismissed:a,parentTop:h,timer:v}},beforeMount(){this.setupContainer()},mounted(){l.on("toast-clear-context",this.onClearContext)},methods:{setupContainer(){if(this.parentTop=document.querySelector(`.v-toast__context-container--${this.context}`),this.parentTop)return;this.parentTop||(this.parentTop=document.createElement("div"),this.parentTop.className=`v-toast__context-container v-toast__context-container--${this.context}`);const t=document.querySelector(".v-toast-container");t==null||t.appendChild(this.parentTop)},showNotice(){const t=this.root.parentElement;this.parentTop&&t&&(this.parentTop.insertAdjacentElement("beforeend",this.root),u(t),this.isActive=!0,this.duration&&this.counter===0&&(this.timer=new C(this.dismiss,this.duration)))},onClearContext(t){this.context===t.context&&this.$.uid!==t.uid&&this.removeToast()},manualDismiss(){this.isManualDismissed=!0,this.dismiss()},dismiss(){this.timer&&this.timer.stop(),this.isActive=!1,this.notificationStore.remove(this),this.counter>1&&l.emit("toast-clear-context",{context:this.context,counter:this.counter,uid:this.$.uid}),setTimeout(()=>this.removeToast(),250)},removeToast(){this.timer&&this.timer.stop(),this.isActive=!1,this.notificationStore.remove(this),this.onDismiss&&this.onDismiss({context:this.context,severity:this.type});const t=this.root;o.render(null,t),u(t),this.parentTop&&this.parentTop.children.length===0&&u(this.parentTop)},toggleTimer(t){!this.pauseOnHover||!this.timer||(t?this.timer.pause():this.timer.resume())}},computed:{transition(){return{enter:"v-toast--fly-in",leave:this.isManualDismissed?"v-toast--fade-out":"v-toast--fly-out"}}},beforeUnmount(){l.off("toast-clear-context",this.onClearContext)}}),x=o.createElementVNode("div",{class:"v-toast__dismiss-icon"},null,-1),N=["textContent"],S=o.createElementVNode("div",{class:"v-toast__icon"},null,-1),w={class:"v-toast__text"},D=["textContent"],O=["innerHTML"];function E(t,e,s,i,n,r){return o.openBlock(),o.createBlock(o.Transition,{"enter-active-class":t.transition.enter,"leave-active-class":t.transition.leave},{default:o.withCtx(()=>[o.withDirectives(o.createElementVNode("div",{ref:"root",role:"alert",class:o.normalizeClass(["v-toast__item",[`v-toast__item--${t.type}`,"v-toast__item--top-right"]]),onMouseover:e[1]||(e[1]=a=>t.toggleTimer(!0)),onMouseleave:e[2]||(e[2]=a=>t.toggleTimer(!1))},[o.createElementVNode("div",{class:o.normalizeClass(["v-toast__dismiss",{"v-toast__dismiss--group":t.counter>1}]),onClick:e[0]||(e[0]=(...a)=>t.manualDismiss&&t.manualDismiss(...a))},[x,o.createElementVNode("div",{class:"v-toast__dismiss-label",textContent:o.toDisplayString(t.labelCloseAll)},null,8,N)],2),S,o.createElementVNode("div",w,[t.title?(o.openBlock(),o.createElementBlock("p",{key:0,class:"v-toast__title",textContent:o.toDisplayString(t.title)},null,8,D)):o.createCommentVNode("",!0),o.createElementVNode("p",{class:"v-toast__message",innerHTML:t.message.substring(0,128)},null,8,O)])],34),[[o.vShow,t.isActive]])]),_:1},8,["enter-active-class","leave-active-class"])}var $=T(b,[["render",E]]);const j=(t={})=>({open(e){let s=null;typeof e=="string"&&(s=e);const n=Object.assign({},{message:s},t,e);return y($,n)},clear(){l.emit("toast-clear")},success(e,s={}){return this.open(Object.assign({},{message:e,type:"success"},s))},error(e,s={}){return this.open(Object.assign({},{message:e,type:"error"},s))},info(e,s={}){return this.open(Object.assign({},{message:e,type:"info"},s))},warning(e,s={}){return this.open(Object.assign({},{message:e,type:"warning"},s))},default(e,s={}){return this.open(Object.assign({},{message:e,type:"default"},s))}}),c=o.ref([]),p={add(t,e,s){c.value.push({uid:t,context:e,severity:s})},state(){return c},remove(t){c.value=c.value.filter(e=>e.uid!==t._.uid)}},d=()=>p,m=t=>{const e=j();return{open(s){let i=null;typeof s=="string"&&(i=s,s={});const r=Object.assign({},{type:"default",context:"default",message:i},t,s),a=e.open(r);a&&(p.add(a.uid,r.context,r.type),a.ctx.showNotice())},error(s,i){const n=Object.assign({},{type:"error",context:"error",message:s},i);this.open(n)},success(s,i){const n=Object.assign({},{type:"success",context:"success",message:s},i);this.open(n)},info(s,i){const n=Object.assign({},{type:"info",context:"info",message:s},i);this.open(n)},warning(s,i){const n=Object.assign({},{type:"warning",context:"warning",message:s},i);this.open(n)},clearAll:()=>{e.clear()}}},f={install(t,e={}){let s=m(e);t.config.globalProperties.$notificationCenter=s,t.provide("$notificationCenter",s)}};exports.NotificationCenterPlugin=f;exports.default=f;exports.useNotificationCenter=m;exports.useNotificationStore=d;
